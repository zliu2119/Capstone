
close all
clear all
clc

b = [ 0   0   0   0   1   0   0   0   0 ]' ;

a = [ 0   0   0   0   1   1   0   1   2 ;
      0   0   0   1   1   1   1   2   1 ;
      0   0   0   1   1   0   2   1   0 ;
      0   1   1   0   1   2   0   1   1 ;
      1   1   1   1   2   1   1   1   1 ;
      1   1   0   2   1   0   1   1   0 ;
      0   1   2   0   0   1   1   0   0 ;
      1   2   1   1   1   1   0   0   0 ;
      2   1   0   1   1   0   0   0   0 ] ;

c = pinv(a) * b ;

c = reshape(c,3,3) ;
printf('\n Inverse:\n') ;
am_pr_mat( c , '%9.4f') ;

h = [ 1 1 1 ; 1 2 1 ; 1 1 1] ;
d = conv2(c,h,'same') ;

printf('\n convolve with h: d=\n') ;
am_pr_mat( d , '%9.4f') ;


% -------------------------------------------

a2 = [ 0   0   0   0   -1   -1   0   -1   9 ;
       0   0   0   -1  -1   -1   -1   9   -1 ;
       0   0   0   -1  -1   0   9   -1   0 ;
       0   -1   -1   0  -1   9   0   -1   -1 ;
      -1   -1   -1   -1  9   -1   -1   -1   -1 ;
      -1   -1   0   9   -1   0   -1   -1   0 ;
       0   -1   9   0   -1   -1   0   0   0 ;
      -1   9   -1   -1  -1   -1   0   0   0 ;
       9   -1   0   -1  -1   0   0   0   0 ] ;

c = pinv(a2) * b ;

c = reshape(c,3,3) ;
printf('\n Inverse:\n') ;
am_pr_mat( c , '%9.4f') ;

h2 = [ -1 -1 -1 ; -1 9 -1 ; -1 -1 -1] ;
d = conv2(c,h2,'same') ;

printf('\n convolve with h: d=\n') ;
am_pr_mat(d, '%9.4f ,')

a3 = [ ]

a4 = [ ]
